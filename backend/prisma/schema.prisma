// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
   url      = env("DATABASE_URL")
}


model Organizator {
  id                Int                 @id @default(autoincrement())
  nume              String
  prenume           String
  email             String              @unique
  parola            String
  grupuriEvenimente GrupEvenimente[]

  @@map("organizatori")
}


model GrupEvenimente {
  id            Int        @id @default(autoincrement())
  nume          String

  organizatorId Int
  organizator   Organizator @relation(fields: [organizatorId], references: [id])

  evenimente    Eveniment[]

  @@map("grupuri_evenimente") // opțional, dacă vrei nume tabel mai clar
}

enum StareEveniment {
  OPEN
  CLOSED
}


model Eveniment {
  id               Int      @id @default(autoincrement())
  titlu            String

  function parseDate(s) {
  return s.endsWith("Z") ? new Date(s) : new Date(s + "Z");
}

start: parseDate(start),
end: parseDate(end),


  stare StareEveniment @default(CLOSED)
  codAcces         String   @unique

  
  grupEvenimenteId Int
  grupEvenimente   GrupEvenimente @relation(fields: [grupEvenimenteId], references: [id])

  prezente         Prezenta[]

  @@map("evenimente")
}


model Participant {
  id          Int          @id @default(autoincrement())
  nume        String
  prenume     String
  email       String?
  prezente    Prezenta[]

  @@map("participanti")
}

model Prezenta {
  id            Int      @id @default(autoincrement())
  moment        DateTime @default(now())

  participantId Int
  participant   Participant @relation(fields: [participantId], references: [id])

  evenimentId   Int
  eveniment     Eveniment @relation(fields: [evenimentId], references: [id])

  @@unique([participantId, evenimentId])
}

